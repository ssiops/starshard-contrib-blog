function editorCtrl(a,b,c,d){a.err={},a.tags=[],a.input="",a.focus=!1;var e=angular.element(b.document.getElementById("blog-tags")).attr("data-value");e&&e.length>0&&(a.tags=e.split(",")),a.addTag=function(){a.input.length<1||a.tags.indexOf(a.input)>=0||(a.tags.push(a.input),a.input="")},a.removeTag=function(b){a.tags.splice(b,1)},a.toolbar={},a.textarea=b.document.getElementById("body"),a.value="",a.insert=function(b){a.value=a.textarea.value;var c=a.textarea.selectionStart,d=a.textarea.selectionEnd;if(b.wrap&&(a.textarea.value=c===d?a.value.substring(0,c)+b.wrap+b.wrap+a.value.substring(d,a.value.length):a.value.substring(0,c)+b.wrap+a.value.substring(c,d)+b.wrap+a.value.substring(d,a.value.length),a.textarea.selectionStart=a.textarea.selectionEnd=c+b.wrap.length),b.home){for(var e=c-1;e>=0&&"\n"!=a.value.charAt(e);e--);e++,a.textarea.value=a.value.substring(0,e)+b.home+a.value.substring(e,a.value.length),a.textarea.selectionStart=a.textarea.selectionEnd=c+b.home.length}b.line&&(a.textarea.value=a.value.substring(0,c)+"\n"+b.line+"\n"+a.value.substring(c,a.value.length),a.textarea.selectionStart=a.textarea.selectionEnd=c+b.line.length+2),b.simple&&(a.textarea.value=a.value.substring(0,c)+b.simple+a.value.substring(c,a.value.length)),a.textarea.focus()},a.submit=function(){var d={title:a.title,"abstract":a.abstract,tags:a.tags,body:a.textarea.value};return a.err={},d.title.length<4?void(a.err.title=!0):d.abstract.length<4?void(a.err.title=!0):d.body.length<20?void(a.err.body=!0):void c.put("/blog/archive",d).success(function(a){a&&a.redirect&&(b.location.href="/blog/archive/"+a.redirect+"/")})},a.getTags=function(a){return c.get("/blog/archive/tags",{params:{t:a}}).then(function(a){return a.data.err&&console.log(a.data.err),a.data.msg&&console.log(a.data.msg),a.data.list})},a.openModal=function(){var b=d.open({templateUrl:"imgUpload.html",controller:modalCtrl});b.result.then(function(b){a.insert({simple:"![ALT]("+b+")"})},function(){console.info("Modal dismissed at: "+new Date)})}}function modalCtrl(a,b,c){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")},a.uploader=c.create({scope:a,url:"/usercontent/blog/img",autoUpload:!0}),a.uploader.progress=0,a.uploader.bind("success",function(a,c,d,e){b.close("/usercontent/blog/"+e.filename)})}angular.module("blog",["angularFileUpload","ui.bootstrap"]);